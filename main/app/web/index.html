<!doctype html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,height=device-height,initial-scale=1">
    <meta name="description" content="PWA for controlling devices using gamepads.">
    <meta name="theme-color" content="#000000">
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/xterm.css" />
    <link rel="icon" type="image/png" sizes="196x196" href="images/favicon.png">
    <script src="script/xterm.js"></script>
    <script src="script/addon-fit.js"></script>
    <script src="script/addon-attach.js"></script>
    <script src="wasm/controller.js" defer=""></script>
</head>

<body>
    <div id="terminal"></div>
    <script>
        const terminal = new Terminal();
        const fitAddon = new FitAddon.FitAddon();

        const port = window.location.port ? parseInt(window.location.port, 10) + 1 : 81;
        const address = `ws://${window.location.hostname}:${port}`;
        const socket = new WebSocket(address);
        const attachAddon = new AttachAddon.AttachAddon(socket);

        terminal.loadAddon(fitAddon);
        terminal.loadAddon(attachAddon);
        terminal.open(document.getElementById('terminal'));

        fitAddon.fit();

        window.addEventListener('resize', () => fitAddon.fit());

        console.clear = () => terminal.clear();
        console.log = message => terminal.writeln(message);
        console.error = message => terminal.writeln('\x1B[1;31m' + message + '\x1B[0m');
        console.info = message => terminal.writeln('\x1B[1;32m' + message + '\x1B[0m');
        console.warn = message => terminal.writeln('\x1B[1;33m' + message + '\x1B[0m');
    </script>
</body>

</html>